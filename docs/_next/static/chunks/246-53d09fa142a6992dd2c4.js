(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[246],{6246:function(t,e,a){"use strict";a.d(e,{Z:function(){return F}});var r=a(1508),n=a(8216),i=a(5997),o=a(4695),s=a(3444),l=a(268),h=a(2953),c=a(2809),d=a(7294),p=a(9033),u=a(8533),g=a(5893);function f(t,e){var a=Object.keys(t);if(Object.getOwnPropertySymbols){var r=Object.getOwnPropertySymbols(t);e&&(r=r.filter((function(e){return Object.getOwnPropertyDescriptor(t,e).enumerable}))),a.push.apply(a,r)}return a}function m(t){for(var e=1;e<arguments.length;e++){var a=null!=arguments[e]?arguments[e]:{};e%2?f(Object(a),!0).forEach((function(e){(0,c.Z)(t,e,a[e])})):Object.getOwnPropertyDescriptors?Object.defineProperties(t,Object.getOwnPropertyDescriptors(a)):f(Object(a)).forEach((function(e){Object.defineProperty(t,e,Object.getOwnPropertyDescriptor(a,e))}))}return t}function v(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,r=(0,h.Z)(t);if(e){var n=(0,h.Z)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.Z)(this,a)}}var x=function(t){(0,s.Z)(a,t);var e=v(a);function a(){var t;return(0,n.Z)(this,a),t=e.call(this),(0,c.Z)((0,o.Z)(t),"state",{selection:void 0}),(0,c.Z)((0,o.Z)(t),"handleInputChange",(function(e){t.setState({selection:e}),e=e||[];for(var a=[],r=0;r<e.length;r++)a.push(e[r].value);t.props.onSelection(a)})),(0,c.Z)((0,o.Z)(t),"promiseOptions",(function(e){var a=t.props.dataSet?t.props.dataSet.getSelectData():[];return new Promise((function(r){var n=new Worker("worker.js"),i={data:a,blacklist:t.props.blacklist,query:e,limit:10};n.postMessage(i),n.addEventListener("message",function(t){for(var e=0;e<t.data.length;e++){var a=this.props.dataSet.getPlayerRating(this.props.ratingLabelOne,t.data[e].value),n=this.props.dataSet.getPlayerRating(this.props.ratingLabelTwo,t.data[e].value);t.data[e].rating="".concat(a||""," / ").concat(n||"")}r(t.data)}.bind((0,o.Z)(t)),!1)}))})),t.styles={control:function(e,a){var r;return m(m({},e),{},(r={boxShadow:"0 0 0 1px ".concat(t.props.color)},(0,c.Z)(r,"boxShadow",a.isFocused?"0 0 0 0.2rem ".concat(t.props.color):0),(0,c.Z)(r,"borderColor",a.isFocused?"".concat(t.props.color):"#CED4DA"),(0,c.Z)(r,"&:hover",{borderColor:a.isFocused?"".concat(t.props.color):"#CED4DA"}),r))}},t.option=function(t){return(0,g.jsx)(u.F.Option,m(m({},t),{},{children:(0,g.jsxs)("div",{style:{display:"flex"},children:[(0,g.jsx)("div",{children:t.data.label}),(0,g.jsx)("div",{style:{paddingLeft:"10px",opacity:.5},children:t.data.rating})]})}))},t}return(0,i.Z)(a,[{key:"componentDidUpdate",value:function(t){var e=this;if(this.props.value&&this.props.dataSet&&t.value!=this.props.value){for(var a=this.props.value.filter((function(t){return e.props.dataSet.exists(t)})),r=[],n=0;n<a.length;n++){var i=a[n];r.push({label:this.props.dataSet.getName(i),value:i})}this.setState({selection:r})}}},{key:"render",value:function(){return(0,g.jsx)(p.ZP,{isMulti:!0,cacheOptions:!0,defaultOptions:!0,loadOptions:this.promiseOptions.bind(this),onChange:this.handleInputChange.bind(this),noOptionsMessage:function(){return"Type a player's name"},value:this.state.selection,styles:this.styles,components:{Option:this.option}})}}]),a}(d.Component),y=a(6397),b=a.n(y),w=a(2820);function A(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,r=(0,h.Z)(t);if(e){var n=(0,h.Z)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.Z)(this,a)}}var R=w.Z.getAllLabels(),T=function(t){(0,s.Z)(a,t);var e=A(a);function a(){var t;(0,n.Z)(this,a);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return t=e.call.apply(e,[this].concat(i)),(0,c.Z)((0,o.Z)(t),"state",{}),t}return(0,i.Z)(a,[{key:"calculateAverage",value:function(t,e,a,r){for(var n=0,i=0,o=0;o<r.length;o++){var s=e.call(t,a,r[o]);s&&(i+=s,n++)}return n>0?i/n:"-"}},{key:"formatAverage",value:function(t){return isNaN(t)?"":Math.round(t)}},{key:"render",value:function(){var t=this.props.data,e=this.props.players.filter((function(e){return t.exists(e)})),a=this.props.color,r=this.props.teamLabel;if(0===e.length||!e)return null;for(var n=[],i=0;i<e.length;i++){var o=e[i],s=t.getPlayerRating(R.NAME,o),l=t.getPlayerRating(this.props.dataLabelOne,o),h=t.getPlayerPercentile(this.props.dataLabelOne,o),c=t.getPlayerRating(this.props.dataLabelTwo,o),d=t.getPlayerPercentile(this.props.dataLabelTwo,o),p=t.getPlayerRating(this.props.dataLabelThree,o),u=t.getPlayerPercentile(this.props.dataLabelThree,o);n.push((0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{width:"28%",children:s}),(0,g.jsx)("th",{width:"12%",style:{borderLeft:"1px solid "+a},children:l}),(0,g.jsx)("th",{width:"12%",children:t.formatPercentage(h)}),(0,g.jsx)("th",{width:"12%",style:{borderLeft:"1px solid "+a},children:c}),(0,g.jsx)("th",{width:"12%",children:t.formatPercentage(d)}),(0,g.jsx)("th",{width:"12%",style:{borderLeft:"1px solid "+a},children:p}),(0,g.jsx)("th",{width:"12%",children:t.formatPercentage(u)})]},"player-"+o))}if(e.length>1){var f=this.calculateAverage(t,t.getPlayerRating,this.props.dataLabelOne,e),m=this.calculateAverage(t,t.getPlayerPercentile,this.props.dataLabelOne,e),v=this.calculateAverage(t,t.getPlayerRating,this.props.dataLabelTwo,e),x=this.calculateAverage(t,t.getPlayerPercentile,this.props.dataLabelTwo,e),y=this.calculateAverage(t,t.getPlayerRating,this.props.dataLabelThree,e),w=this.calculateAverage(t,t.getPlayerPercentile,this.props.dataLabelThree,e);n.push((0,g.jsxs)("tr",{style:{borderTop:"1px solid "+a},children:[(0,g.jsx)("th",{className:b().teamAvgRow,children:(0,g.jsxs)("b",{children:[r," Avg"]})}),(0,g.jsx)("th",{className:b().teamAvgRow,style:{borderLeft:"1px solid "+a},children:(0,g.jsx)("b",{children:this.formatAverage(f)})}),(0,g.jsx)("th",{className:b().teamAvgRow,children:(0,g.jsx)("b",{children:t.formatPercentage(m)})}),(0,g.jsx)("th",{className:b().teamAvgRow,style:{borderLeft:"1px solid "+a},children:(0,g.jsx)("b",{children:this.formatAverage(v)})}),(0,g.jsx)("th",{className:b().teamAvgRow,children:(0,g.jsx)("b",{children:t.formatPercentage(x)})}),(0,g.jsx)("th",{className:b().teamAvgRow,style:{borderLeft:"1px solid "+a},children:(0,g.jsx)("b",{children:this.formatAverage(y)})}),(0,g.jsx)("th",{className:b().teamAvgRow,children:(0,g.jsx)("b",{children:t.formatPercentage(w)})})]}))}return(0,g.jsx)("div",{className:b().teamTable,style:{borderColor:this.props.color},children:(0,g.jsx)("table",{style:{width:"100%",borderSpacing:"0px",fontSize:"12px",borderCollapse:"collapse",tableLayout:"fixed"},children:(0,g.jsx)("tbody",{children:n})})})}}]),a}(d.Component),M=a(2184),_=function(){function t(e,a,r){(0,n.Z)(this,t),this.tree=M(),this.values=[];var i=0;for(var o in e){var s=e[o][a];if(r||this.values.push(s),void 0!==s){var l=this.tree.find(s);null===l||null===l.node?this.tree=this.tree.insert(s,1):l.node.value=l.node.value+1,i++}}for(var h=0,c=this.tree.begin;c.hasNext;c.next()){var d=h/(i-1);h+=c.node.value,c.node.value=d}}return(0,i.Z)(t,[{key:"getPercentile",value:function(t){return this.tree.le(t).value}},{key:"getAllNumbers",value:function(){return this.values}}]),t}(),j=w.Z.getAllLabels(),P=function(){function t(e){(0,n.Z)(this,t),this.rawData=void 0;try{this.rawData=JSON.parse(e)}catch(p){throw console.log("An error occurred while parsing",e),p}for(var a in this.rawData){var r=j.RANDOM_MAP_RATING,i=j.TEAM_RANDOM_MAP_RATING;if(this.rawData[a][r]&&this.rawData[a][i]){var o=Math.round(Math.round(Math.sqrt(Math.pow(this.rawData[a][r],2)+Math.pow(this.rawData[a][i],2))));this.rawData[a][j.RANDOM_MAP_COMBO_RATING]=o}if(r=j.DEATHMATCH_RATING,i=j.TEAM_DEATHMATCH_RATING,this.rawData[a][r]&&this.rawData[a][i]){var s=Math.round(Math.round(Math.sqrt(Math.pow(this.rawData[a][r],2)+Math.pow(this.rawData[a][i],2))));this.rawData[a][j.DEATHMATCH_COMBO_RATING]=s}if(r=j.EMPIRE_WARS_RATING,i=j.EMPIRE_WARS_TEAM_RATING,this.rawData[a][r]&&this.rawData[a][i]){var l=Math.round(Math.round(Math.sqrt(Math.pow(this.rawData[a][r],2)+Math.pow(this.rawData[a][i],2))));this.rawData[a][j.EMPIRE_WARS_COMBO_RATING]=l}}var h={};for(var c in h[j.RANDOM_MAP_RATING]=new _(this.rawData,j.RANDOM_MAP_RATING),h[j.TEAM_RANDOM_MAP_RATING]=new _(this.rawData,j.TEAM_RANDOM_MAP_RATING),h[j.RANDOM_MAP_COMBO_RATING]=new _(this.rawData,j.RANDOM_MAP_COMBO_RATING,!0),h[j.DEATHMATCH_RATING]=new _(this.rawData,j.DEATHMATCH_RATING),h[j.TEAM_DEATHMATCH_RATING]=new _(this.rawData,j.TEAM_DEATHMATCH_RATING),h[j.DEATHMATCH_COMBO_RATING]=new _(this.rawData,j.DEATHMATCH_COMBO_RATING,!0),h[j.UNRANKED_RATING]=new _(this.rawData,j.UNRANKED_RATING,!0),h[j.EMPIRE_WARS_RATING]=new _(this.rawData,j.EMPIRE_WARS_RATING),h[j.EMPIRE_WARS_TEAM_RATING]=new _(this.rawData,j.EMPIRE_WARS_TEAM_RATING),h[j.EMPIRE_WARS_COMBO_RATING]=new _(this.rawData,j.EMPIRE_WARS_COMBO_RATING,!0),this.percentileTrees=h,this.selectData=[],this.rawData)this.selectData.push({value:c,label:this.rawData[c][j.NAME]});for(var d in this.names=[],this.rawData)this.names.push(this.rawData[d][j.NAME])}return(0,i.Z)(t,[{key:"exists",value:function(t){return Boolean(this.rawData[t])}},{key:"getName",value:function(t){return this.rawData[t][j.NAME]}},{key:"getAllNames",value:function(){return this.names}},{key:"getSelectData",value:function(){return this.selectData}},{key:"getPlayerRating",value:function(t,e){return this.rawData[e][t]}},{key:"getPlayerPercentile",value:function(t,e){var a=this.getPlayerRating(t,e);return this.getPercentileForRating(t,a)}},{key:"getRatingsArray",value:function(t){return this.percentileTrees[t].getAllNumbers()}},{key:"getPercentileForRating",value:function(t,e){if(void 0!==e)return this.percentileTrees[t].getPercentile(e)}},{key:"formatPercentage",value:function(t){if(null===t||void 0===t||isNaN(t))return"-";if(1==t)return"100%";var e=(100*t).toString();return(e=e.slice(0,e.indexOf(".")+2))+"%"}}]),t}(),N=a(809),O=a.n(N);Number.prototype.clamp=function(t,e){return Math.min(Math.max(this,t),e)};var D=!1,L=function(){function t(e,a,r,i,o){(0,n.Z)(this,t),this.inputAnnotations=e;var s=r-a,l=o-i;this.annotationWidth=s/5,this.annotationHeight=l/12,this.minX=a+this.annotationWidth/2,this.maxX=r-this.annotationWidth/2,this.minY=i,this.maxY=o;var h=this.maxX-this.minX,c=this.maxY-this.minY;this.numberOfXPartitions=Math.trunc(h/this.annotationWidth),this.numberOfYPartitions=Math.trunc(c/this.annotationHeight),this.usedIndexes=new Set}return(0,i.Z)(t,[{key:"getClosestPartitionIndex",value:function(t,e,a,r){var n=(t-e)/(a-e)*r;return Math.round(n)}},{key:"getCoordinatesFromPartitionIndex",value:function(t,e,a){return e+t*a}},{key:"calculateAndReserveNearestValidPartitionIndex",value:function(t,e,a,r){var n=t,i=e,o=this.getNextNearestPartitionIndexes(n,i,0,0,this.numberOfXPartitions,this.numberOfYPartitions),s=0,l=null,h=null;for(D;s<25;){if(null==(l=o.next().value))return null;if(h=JSON.stringify(l),this.usedIndexes.has(h))s++;else{for(var c=this.getCoordinatesFromPartitionIndex(l.x,this.minX,this.annotationWidth),d=this.getCoordinatesFromPartitionIndex(l.y,this.minY,this.annotationHeight),p=!1,u=0;u<r.length;u++){var g=r[u],f=Math.abs(g.x-c),m=Math.abs(g.y-d),v=this.annotationWidth/2.1,x=this.annotationHeight/2.1;if(f<v&&m<x){D,s++,p=!0;break}}if(!p)break}}return this.usedIndexes.add(h),{x:l.x,y:l.y}}},{key:"getNextNearestPartitionIndexes",value:O().mark((function t(e,a,r,n,i,o){var s,l,h,c,d,p,u;return O().wrap((function(t){for(;;)switch(t.prev=t.next){case 0:e<r?e=r:e>i&&(e=i),a<n?a=n:a>o&&(a=o),s=[{x:e,y:a}],(l=new Set).add(JSON.stringify(s[0]));case 5:if(0!==s.length){t.next=9;break}return console.log("No more valid locations to search"),t.abrupt("return",null);case 9:for(h=s.shift(),c=[{x:h.x+1,y:h.y},{x:h.x-1,y:h.y},{x:h.x,y:h.y+1},{x:h.x,y:h.y-1}],d=0;d<c.length;d++)p=c[d],u=JSON.stringify(c[d]),l.has(u)||p.x>=r&&p.x<=i&&p.y>=n&&p.y<=o&&(l.add(u),s.push(p));return t.next=14,h;case 14:t.next=5;break;case 16:case"end":return t.stop()}}),t)}))},{key:"doLineSegmentsIntersect",value:function(t,e,a,r,n,i,o,s){var l,h,c;return 0!==(l=(a-t)*(s-i)-(o-n)*(r-e))&&(h=((e-r)*(o-t)+(a-t)*(s-e))/l,0<(c=((s-i)*(o-t)+(n-o)*(s-e))/l)&&c<1&&0<h&&h<1)}},{key:"doesPointIntersectRectable",value:function(t,e){var a=t.x,r=t.y,n=e.left,i=e.right,o=e.top,s=e.bottom;return a<=i&&a>=n&&r>=s&&r<=o}},{key:"getSeparatedAnnotations",value:function(){for(var t=0;t<this.inputAnnotations.length;t++){var e=this.inputAnnotations[t],a=this.getClosestPartitionIndex(e.ax,this.minX,this.maxX,this.numberOfXPartitions),r=this.getClosestPartitionIndex(e.ay,this.minY,this.maxY,this.numberOfYPartitions),n=this.calculateAndReserveNearestValidPartitionIndex(a,r,e,this.inputAnnotations);if(null!==n){a=n.x,r=n.y;var i=this.getCoordinatesFromPartitionIndex(a,this.minX,this.annotationWidth),o=this.getCoordinatesFromPartitionIndex(r,this.minY,this.annotationHeight);e.ax=i,e.ay=o}else console.log("Unable to find a good place for the annotation: ",e.text)}for(var s=0;s<this.inputAnnotations.length;s++)for(var l=this.inputAnnotations[s],h=s;h<this.inputAnnotations.length;h++){var c=this.inputAnnotations[h];if(l!==c)if(this.doLineSegmentsIntersect(l.x,l.y,l.ax,l.ay,c.x,c.y,c.ax,c.ay)){var d=l.ax,p=l.ay;l.ax=c.ax,l.ay=c.ay,c.ax=d,c.ay=p}}return this.inputAnnotations.sort((function(t,e){var a=Math.abs(t.x-t.ax),r=Math.abs(t.y-t.ay),n=Math.abs(e.x-e.ax),i=Math.abs(e.y-e.ay);return Math.sqrt(n*n+i*i)-Math.sqrt(a*a+r*r)})),this.inputAnnotations}}]),t}(),I=a(8849),E=a.n(I);function k(t){var e=function(){if("undefined"===typeof Reflect||!Reflect.construct)return!1;if(Reflect.construct.sham)return!1;if("function"===typeof Proxy)return!0;try{return Boolean.prototype.valueOf.call(Reflect.construct(Boolean,[],(function(){}))),!0}catch(t){return!1}}();return function(){var a,r=(0,h.Z)(t);if(e){var n=(0,h.Z)(this).constructor;a=Reflect.construct(r,arguments,n)}else a=r.apply(this,arguments);return(0,l.Z)(this,a)}}var S="#0eac22",Z="#6311a5",C="#fe9918",G="#000000",H=14,B="#7f7f7f",z="Roboto, Arial, sans-serif",W={l:50,r:15,t:50,b:40},F=function(t){(0,s.Z)(a,t);var e=k(a);function a(){var t;(0,n.Z)(this,a);for(var r=arguments.length,i=new Array(r),s=0;s<r;s++)i[s]=arguments[s];return t=e.call.apply(e,[this].concat(i)),(0,c.Z)((0,o.Z)(t),"state",{data:null,teamOne:[],teamTwo:[]}),t}return(0,i.Z)(a,[{key:"componentDidMount",value:function(){for(var t=new Date,e=new P(this.props.data),a=[],n=this.props.timestamp?this.props.timestamp:0,i=e.getRatingsArray(this.props.dataLabelOne),o=e.getRatingsArray(this.props.dataLabelTwo),s=Math.min.apply(Math,(0,r.Z)([].concat((0,r.Z)(i),(0,r.Z)(o)).filter(Boolean))).clamp(0,1/0),l=Math.max.apply(Math,(0,r.Z)([].concat((0,r.Z)(i),(0,r.Z)(o)).filter(Boolean))).clamp(0,1/0),h={start:0,end:3500,size:10},c=i.filter(Boolean).length,d={x:i,type:"histogram",marker:{color:S},hovertemplate:"# of Players: %{y}<br>Rating Range: %{x}<br>Percentile: %{text}<extra></extra>",selected:{marker:{color:"red"}},showlegend:!0,name:"N = ".concat(c.toLocaleString()),autobinx:c<1e3,xbins:h,hovermode:"x unified",hoveron:"points+fills"},p={title:{text:this.props.chartOneLabel,font:{family:z,size:18},xanchor:"center",yanchor:"bottom"},margin:W,xaxis:{title:{text:"Rating",font:{family:z,size:H,color:B}},range:[s,l],fixedrange:!0},yaxis:{title:{text:"Number of Players",font:{family:z,size:H,color:B}},fixedrange:!0},marker:{color:S},hovermode:"false",legend:{x:1,y:1,xanchor:"right"}},u=[d],g=Plotly.newPlot("random_map_histogram",u,p,{scrollZoom:!1,responsive:!0,showLink:!0,plotlyServerURL:"https://chart-studio.plotly.com"}),f=[],m=0;m<a.length;m++)f[m]=a[m][2];for(var v=o.filter(Boolean).length,x={x:o,type:"histogram",marker:{color:S},showlegend:!0,name:"N = ".concat(v.toLocaleString()),autobinx:v<1e3,xbins:h,hovertemplate:"# of Players: %{y}<br>Rating Range: %{x}<br>Percentile: %{text}<extra></extra>"},y={title:{text:this.props.chartTwoLabel,font:{family:z,size:18},xanchor:"center",yanchor:"bottom"},margin:W,xaxis:{title:{text:"Rating",font:{family:z,size:H,color:B}},range:[s,l],fixedrange:!0},yaxis:{title:{text:"Number of Players",font:{family:z,size:H,color:B}},fixedrange:!0},legend:{x:1,y:1,xanchor:"right"}},b=[x],A=Plotly.newPlot("team_random_map_histogram",b,y,{scrollZoom:!1,responsive:!0,showLink:!0,plotlyServerURL:"https://chart-studio.plotly.com"}),R=e.getAllNames(),T=i,M=o,_=[],j=[],N=[],O=0;O<i.length;O++)void 0!==T[O]&&void 0!==M[O]&&(_.push(R[O]),j.push(T[O]),N.push(M[O]));var D={x:j,y:N,text:_,mode:"markers",type:"scattergl",textposition:"top center",textfont:{family:z},marker:{size:2,color:S},hovertemplate:"Name: %{text}<br>Team: %{y}<br>1v1: %{x}<extra></extra>"},L=Math.min.apply(Math,j),I=Math.max.apply(Math,j),E=[function(t,e,a,r){var n=w.Z.linearRegression(e,t),i=a,o=r;return{y:[i*n.slope+n.intercept,o*n.slope+n.intercept],x:[i,o],mode:"lines",type:"scattergl",name:"R2=".concat(n.r2.toFixed(3)),hovertemplate:"y=".concat(n.slope.toFixed(3),"*x+").concat(n.intercept.toFixed(3)),line:{width:.5,color:G,opacity:.5}}}(j,N,L,I),D],k={hovermode:"closest",showlegend:!1,title:{text:this.props.chartOneLabel+" vs<br>"+this.props.chartTwoLabel,font:{family:z,size:18},xanchor:"center",yanchor:"bottom"},margin:W,xaxis:{title:{text:"1v1 Rating",font:{family:z,size:H,color:B}},range:[L,I],fixedrange:!0},yaxis:{title:{text:"Team Rating",font:{family:z,size:H,color:B}},fixedrange:!0}},Z=Plotly.newPlot("combo_scatterplot",E,k,{scrollZoom:!1,responsive:!0,showLink:!0,plotlyServerURL:"https://chart-studio.plotly.com"}),C=document.getElementById("last_updated"),F=new Date(n);try{C.innerHTML="\u2020 Last updated on <i>".concat(F.toLocaleString("default",{timeZoneName:"short"}),"</i>")}catch(Y){return Y instanceof RangeError}Promise.all([g,A,Z]).then(function(a){document.getElementById("loading-hider").classList.remove("hidden"),document.getElementById("loading").classList.add("none"),this.randomMapDiv=a[0],this.teamRandomMapDiv=a[1],this.scatterplotDiv=a[2],this.randomMapDiv.addEventListener("touchstart",(function(t){t.stopPropagation()}),!0),this.teamRandomMapDiv.addEventListener("touchstart",(function(t){t.stopPropagation()}),!0),this.scatterplotDiv.addEventListener("touchstart",(function(t){t.stopPropagation()}),!0),X(this.randomMapDiv,e,this.props.dataLabelOne),X(this.teamRandomMapDiv,e,this.props.dataLabelTwo);var r=function(t){for(var e={},a=("?"===t[0]?t.substr(1):t).split("&"),r=0;r<a.length;r++){var n=a[r].split("=");e[decodeURIComponent(n[0])]=decodeURIComponent(n[1]||"")}return e}(window.location.search);this.setState({data:e,teamOne:r.team_one?r.team_one.split("-"):[],teamTwo:r.team_two?r.team_two.split("-"):[]}),gtag("event","timing_complete",{name:"Load "+this.props.title,value:new Date-t,event_category:"JS Dependencies"})}.bind(this))}},{key:"componentDidUpdate",value:function(){var t=this;if(this.randomMapDiv&&this.teamRandomMapDiv&&this.scatterplotDiv){for(var e=(new Date).getTime(),a=this.state.teamOne?this.state.teamOne.filter((function(e){return t.state.data.exists(e)})):[],r=this.state.teamTwo?this.state.teamTwo.filter((function(e){return t.state.data.exists(e)})):[],n=[],i=0;i<a.length;i++)n.push({color:Z,value:this.state.data.getPlayerRating(this.props.dataLabelOne,a[i]),name:this.state.data.getName(a[i])});for(var o=0;o<r.length;o++)n.push({color:C,value:this.state.data.getPlayerRating(this.props.dataLabelOne,r[o]),name:this.state.data.getName(r[o])});Y(this.randomMapDiv,n);for(var s=[],l=0;l<a.length;l++)s.push({color:Z,value:this.state.data.getPlayerRating(this.props.dataLabelTwo,a[l]),name:this.state.data.getName(a[l])});for(var h=0;h<r.length;h++)s.push({color:C,value:this.state.data.getPlayerRating(this.props.dataLabelTwo,r[h]),name:this.state.data.getName(r[h])});Y(this.teamRandomMapDiv,s);for(var c=[],d=0;d<a.length;d++)c.push({color:Z,valueX:this.state.data.getPlayerRating(this.props.dataLabelOne,a[d]),valueY:this.state.data.getPlayerRating(this.props.dataLabelTwo,a[d]),name:this.state.data.getName(a[d])});for(var p=0;p<r.length;p++)c.push({color:C,valueX:this.state.data.getPlayerRating(this.props.dataLabelOne,r[p]),valueY:this.state.data.getPlayerRating(this.props.dataLabelTwo,r[p]),name:this.state.data.getName(r[p])});!function(t,e){for(var a=0,r={},n=0;n<e.length;n++)void 0===r[e[n].color]?(r[e[n].color]={counter:a,x:[e[n].valueX],y:[e[n].valueY]},a++):(r[e[n].color].x.push(e[n].valueX),r[e[n].color].y.push(e[n].valueY));for(;t.data.length>=3;)Plotly.deleteTraces(t,2);var i=[];for(var o in r){var s={x:r[o].x,y:r[o].y,mode:"markers",type:"scattergl",textposition:"top center",marker:{size:8,color:o},hoverinfo:"skip"};i.push(s)}t.layout.xaxis.range[1],t.layout.xaxis.range[0];for(var l=t.layout.yaxis.range[1]-t.layout.yaxis.range[0],h=[],c=0;c<e.length;c++)if(e[c].valueX&&e[c].valueY){var d={text:e[c].name,x:e[c].valueX,y:e[c].valueY,ax:e[c].valueX,ay:e[c].valueY+l/10,axref:"x",ayref:"y",bgcolor:"rgba(255, 255, 255, 0.9)",arrowcolor:"rgba(0, 0, 0, 0.9)",font:{size:12},bordercolor:e[c].color,borderwidth:1,arrowsize:1,arrowwidth:1};h.push(d)}var p={annotations:new L(h,t.layout.xaxis.range[0],t.layout.xaxis.range[1],t.layout.yaxis.range[0],t.layout.yaxis.range[1]).getSeparatedAnnotations()};Plotly.react(t,t.data.concat(i),Object.assign(t.layout,p),t.config)}(this.scatterplotDiv,c),gtag("event","select_content",{event_label:window.location.pathname+window.location.search}),console.log("Update time ",(new Date).getTime()-e)}}},{key:"render",value:function(){var t=null;return 0===this.state.teamOne.length&&0===this.state.teamTwo.length||(t=(0,g.jsxs)("div",{children:[(0,g.jsx)("div",{children:(0,g.jsx)("table",{className:"tg",style:{fontSize:"12px",width:"100%",tableLayout:"fixed",overflow:"hidden",textAlign:"center",borderCollapse:"collapse"},children:(0,g.jsxs)("tbody",{children:[(0,g.jsxs)("tr",{children:[(0,g.jsx)("th",{rowSpan:"2",width:"28%"}),(0,g.jsx)("th",{colSpan:"2",width:"24%",children:"1v1"}),(0,g.jsx)("th",{colSpan:"2",width:"24%",children:"Team"}),(0,g.jsx)("th",{colSpan:"2",width:"24%",children:"Combo*"})]}),(0,g.jsxs)("tr",{children:[(0,g.jsx)("td",{width:"12%",children:"Rating"}),(0,g.jsx)("td",{width:"12%",children:"%"}),(0,g.jsx)("td",{width:"12%",children:"Rating"}),(0,g.jsx)("td",{width:"12%",children:"%"}),(0,g.jsx)("td",{width:"12%",children:"Rating"}),(0,g.jsx)("td",{width:"12%",children:"%"})]})]})})}),(0,g.jsx)(T,{teamLabel:"Team 1",data:this.state.data,players:this.state.teamOne,color:Z,dataLabelOne:this.props.dataLabelOne,dataLabelTwo:this.props.dataLabelTwo,dataLabelThree:this.props.dataLabelThree}),(0,g.jsx)(T,{teamLabel:"Team 2",data:this.state.data,players:this.state.teamTwo,color:C,dataLabelOne:this.props.dataLabelOne,dataLabelTwo:this.props.dataLabelTwo,dataLabelThree:this.props.dataLabelThree})]})),(0,g.jsxs)("html",{children:[(0,g.jsxs)("head",{children:[(0,g.jsx)("title",{children:"Age of Empires II: Definitive Edition Rating Charts"}),(0,g.jsx)("meta",{name:"description",content:"Histograms and a scatterplot for 'Age of Empires II: Definitive Edition' 1v1 Random Map and Team Random Map ratings elo. Updated daily."}),(0,g.jsx)("meta",{property:"og:image",content:"https://i.imgur.com/cVLgt68.png"}),(0,g.jsx)("script",{type:"text/javascript",src:"https://cdn.plot.ly/plotly-strict-2.0.0-rc.0.min.js"}),(0,g.jsx)("script",{async:!0,src:"https://www.googletagmanager.com/gtag/js?id=UA-163727547-1"}),(0,g.jsx)("script",{src:"ga.js"}),(0,g.jsx)("link",{rel:"shortcut icon",href:"/favicon.ico"})]}),(0,g.jsx)("body",{style:{fontFamily:z},children:(0,g.jsxs)("div",{className:E().center,children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("h2",{children:"Age of Empires II: Definitive Edition Rating Charts"}),(0,g.jsx)("div",{id:"subheader",style:{paddingBottom:"16px",marginTop:"-16px",fontSize:"9pt"},children:(0,g.jsxs)("i",{children:[this.props.title,". See instead"," ",(0,g.jsx)("a",{href:this.props.chartAltLink,children:this.props.chartAltLinkText}),(0,g.jsx)("br",{}),"Updated daily\u2020"]})})]}),(0,g.jsx)("div",{id:"loading",style:{zIndex:1,margin:"auto",width:"8%",marginTop:"100px"},children:(0,g.jsxs)("div",{className:"loading-spinner",children:[(0,g.jsx)("div",{className:"spinner-dot"}),(0,g.jsx)("div",{className:"spinner-dot"}),(0,g.jsx)("div",{className:"spinner-dot"}),(0,g.jsx)("div",{className:"spinner-dot"}),(0,g.jsx)("div",{className:"spinner-dot"}),(0,g.jsx)("div",{className:"spinner-dot"})]})}),(0,g.jsxs)("div",{id:"loading-hider",className:"hidden",children:[(0,g.jsxs)("div",{id:"selectors",children:[(0,g.jsxs)("div",{children:[(0,g.jsx)("label",{htmlFor:"teamOne",children:"Team 1:"}),(0,g.jsx)("div",{style:{border:Z,borderStyle:"solid",borderRadius:"7px"},children:(0,g.jsx)(x,{id:"teamOne",color:Z,dataSet:this.state.data,blacklist:this.state.teamTwo,value:this.state.teamOne,ratingLabelOne:this.props.dataLabelOne,ratingLabelTwo:this.props.dataLabelTwo,onSelection:function(t){setTimeout(function(){this.setState({teamOne:t})}.bind(this),1),history&&history.pushState(null,"","?team_one="+t.join("-")+"&team_two="+this.state.teamTwo.join("-"))}.bind(this)})})]}),(0,g.jsxs)("div",{style:{marginTop:"16px"},children:[(0,g.jsx)("label",{htmlFor:"teamTwo",children:"Team 2:"}),(0,g.jsx)("div",{style:{border:C,borderStyle:"solid",borderRadius:"7px"},children:(0,g.jsx)(x,{id:"teamTwo",color:C,dataSet:this.state.data,blacklist:this.state.teamOne,value:this.state.teamTwo,ratingLabelOne:this.props.dataLabelOne,ratingLabelTwo:this.props.dataLabelTwo,onSelection:function(t){setTimeout(function(){this.setState({teamTwo:t})}.bind(this),1),history&&history.pushState(null,"","?team_one="+this.state.teamOne.join("-")+"&team_two="+t.join("-"))}.bind(this)})})]})]}),(0,g.jsx)("hr",{className:E().divider}),(0,g.jsx)("div",{id:"table",children:t}),(0,g.jsx)("hr",{className:E().divider}),(0,g.jsx)("div",{id:"random_map_histogram"}),(0,g.jsx)("div",{id:"team_random_map_histogram"}),(0,g.jsx)("div",{id:"combo_scatterplot"})]}),(0,g.jsxs)("div",{id:"footer",style:{fontSize:"12px",margin:"10px"},children:[(0,g.jsx)("div",{id:"last_updated"}),"* Combo rating = Sqrt(RandomMapRating^2 + TeamRandomMapRating^2)",(0,g.jsx)("br",{}),"Players will only appear if they have played at least 10 ranked games and at least one ranked game in the last 28 days",(0,g.jsx)("br",{}),(0,g.jsx)("br",{}),(0,g.jsx)("a",{href:"https://endlesswips.com/aoe2-de-rating-charts#ratings",children:"About"}),(0,g.jsx)("br",{})," View source code on"," ",(0,g.jsx)("a",{href:"https://github.com/SiegeEngineers/aoe2-de-rating-charts",children:"github"}),(0,g.jsx)("br",{}),"Data from"," ",(0,g.jsx)("a",{href:"https://aoe2.net/#api",children:"https://aoe2.net/#api"})]})]})})]})}}]),a}(d.Component);function Y(t,e){var a=t.calcdata[0].length;e=e.filter((function(t){return t.value}));for(var r=1,n={},i=0;i<e.length;i++){var o=e[i].color;void 0===n[o]&&(n[o]=r,r++)}e.sort((function(t,e){return t.value-e.value}));for(var s=0,l=new Array(a).fill(0),h=0;h<a;h++){for(;s<e.length&&e[s].value>=t.calcdata[0][h].ph0&&e[s].value<=t.calcdata[0][h].ph1;)l[h]=n[e[s].color],e[s].bucketIndex=h,s++;if(s>=e.length)break}var c=Object.keys(n).length,d=[[0,S]];for(var p in n){var u=[n[p]/c,p];d.push(u)}var g={};g=1==d.length?{"marker.color":d[0][1]}:{"marker.color":[l],"marker.colorscale":[d],"marker.cmax":c,"marker.cmin":0};for(var f=t.layout.xaxis.range[1]-t.layout.xaxis.range[0],m=(t.layout.yaxis.range[1],t.layout.yaxis.range[0],[]),v=0;v<e.length;v++)if(e[v].value){var x={text:e[v].name,x:e[v].value,y:t.calcdata[0][e[v].bucketIndex].s,ax:e[v].value,ay:t.calcdata[0][e[v].bucketIndex].s+f/10,axref:"x",ayref:"y",bgcolor:"rgba(255, 255, 255, 0.9)",arrowcolor:"rgba(0, 0, 0, 0.9)",font:{size:12},bordercolor:e[v].color,borderwidth:1,arrowsize:1,arrowwidth:1};m.push(x)}var y={annotations:new L(m,t.layout.xaxis.range[0],t.layout.xaxis.range[1],t.layout.yaxis.range[0],t.layout.yaxis.range[1]).getSeparatedAnnotations()};Object.assign(t.layout,y),Plotly.restyle(t,g)}function X(t,e,a){for(var r=t.calcdata[0].length,n=[],i=0;i<r;i++){var o=t.calcdata[0][i].p;n.push(e.formatPercentage(e.getPercentileForRating(a,o)))}var s={text:[n]};Plotly.update(t,s)}},2820:function(t,e,a){"use strict";var r=a(8216),n=a(5997),i=function(){function t(){(0,r.Z)(this,t)}return(0,n.Z)(t,null,[{key:"invert",value:function(t){var e={};for(var a in t)e[t[a]]=a;return e}},{key:"getLeaderboardLabels",value:function(){return Object.freeze({0:"0",1:"1",2:"2",3:"3",4:"4",13:"7",14:"8"})}},{key:"getAllLabels",value:function(){return Object.freeze({NAME:"N",UNRANKED_RATING:"0",DEATHMATCH_RATING:"1",TEAM_DEATHMATCH_RATING:"2",RANDOM_MAP_RATING:"3",TEAM_RANDOM_MAP_RATING:"4",RANDOM_MAP_COMBO_RATING:"5",DEATHMATCH_COMBO_RATING:"6",EMPIRE_WARS_RATING:"7",EMPIRE_WARS_TEAM_RATING:"8",EMPIRE_WARS_COMBO_RATING:"9"})}},{key:"linearRegression",value:function(t,e){for(var a={},r=t.length,n=0,i=0,o=0,s=0,l=0,h=0;h<t.length;h++)n+=e[h],i+=t[h],o+=e[h]*t[h],s+=e[h]*e[h],l+=t[h]*t[h];return console.log(n,i,o,s,l),a.slope=(r*o-n*i)/(r*s-n*n),a.intercept=(i-a.slope*n)/r,a.r2=Math.pow((r*o-n*i)/Math.sqrt((r*s-n*n)*(r*l-i*i)),2),a}}]),t}();e.Z=i},8849:function(t){t.exports={divider:"page_divider__1swgm",center:"page_center__3-ZJh"}},6397:function(t){t.exports={teamTable:"team-table_teamTable__2Ziyz",teamAvgRow:"team-table_teamAvgRow__1FBYc"}}}]);